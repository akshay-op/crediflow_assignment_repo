{"ast":null,"code":"import React,{useState}from'react';import{Card}from\"../components/ui/card\";import{Button}from\"../components/ui/button\";import{Upload}from\"lucide-react\";import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UploadPage=()=>{const[file,setFile]=useState(null);const[uploadSuccess,setUploadSuccess]=useState(false);// Track if upload was successful\nconst navigate=useNavigate();const[loading,setLoading]=useState(false);const handleFileChange=e=>{const selectedFile=e.target.files[0];setFile(selectedFile);console.log('File selected:',selectedFile);};const handleDragOver=e=>{e.preventDefault();e.stopPropagation();};const handleDrop=e=>{e.preventDefault();e.stopPropagation();const droppedFile=e.dataTransfer.files[0];setFile(droppedFile);console.log('File dropped:',droppedFile);};const handleUpload=async()=>{// Make this function async\nif(!file){alert('Please select a file first');return;}const formData=new FormData();formData.append('file',file);try{// Replace with your Flask API endpoint\nconst response=await axios.post('https://crediflowassignmentrepo-production.up.railway.app/upload',formData,{headers:{'Content-Type':'multipart/form-data'}});console.log('File uploaded successfully:',response.data);alert('File uploaded successfully!');setUploadSuccess(true);}catch(error){console.error('Error uploading file:',error);alert('Error uploading file');}};const handleExtract=async()=>{try{setLoading(true);await new Promise(resolve=>setTimeout(resolve,50));console.log(\"f name:\",file.name);//   API call to start process \nconst response=await fetch('https://crediflowassignmentrepo-production.up.railway.app/start-process',{method:'POST',headers:{'Content-Type':'application/json'//  this is very important\n},body:JSON.stringify({fileName:file.name})});if(response.ok){const data=await response.json();console.log('API Success:',data);// Stop loading first\nsetLoading(false);// navigate to report\nnavigate('/report',{state:{myData:data['message']}});}else{//  API failed \nconst errorData=await response.json();console.error('API Error:',errorData);setLoading(false);// stop loading\nalert(errorData.message||'Something went wrong. Please try again.');}}catch(error){console.error('Error during extraction:',error);alert('Something went wrong. Please try again.');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen flex flex-col items-center justify-center p-4 md:p-8 bg-gradient-to-br from-emerald-600 to-teal-700\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full max-w-3xl text-center mb-8\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl md:text-4xl font-bold text-white mb-2\",children:\"Crediflow report\"})}),/*#__PURE__*/_jsxs(Card,{className:\"w-full max-w-xl p-6 md:p-8 shadow-2xl bg-white/95 rounded-3xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-6\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-emerald-700\",children:\"Upload File\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-dashed border-emerald-600/30 rounded-xl p-8 md:p-12 text-center cursor-pointer hover:border-emerald-600/50 transition-colors\",onDragOver:handleDragOver,onDrop:handleDrop,onClick:()=>document.getElementById('fileInput').click(),children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",className:\"hidden\",onChange:handleFileChange,accept:\".pdf,.doc,.docx,.txt\"}),/*#__PURE__*/_jsx(Upload,{className:\"mx-auto h-12 w-12 text-emerald-600 mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm md:text-base text-gray-600 mb-2\",children:\"Drag and drop your file here or click to browse\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:file?file.name:'Supported formats: PDF, DOC, DOCX, TXT'})]}),file&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 text-center\",children:/*#__PURE__*/_jsx(Button// className=\"bg-emerald-600 hover:bg-emerald-700 text-white px-8\"\n,{className:\"bg-emerald-600 hover:bg-emerald-700 text-white px-10 py-2 text-lg rounded-md\",onClick:handleUpload// Trigger the file upload when clicked\n,children:\"Upload File\"})}),uploadSuccess&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 text-center\",children:/*#__PURE__*/_jsx(Button,{className:\"bg-teal-600 hover:bg-teal-700 text-white px-10 py-2 text-lg rounded-md\",onClick:handleExtract,disabled:loading,children:loading?'Etracting...':'Extract'})})]})]});};export default UploadPage;","map":{"version":3,"names":["React","useState","Card","Button","Upload","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","UploadPage","file","setFile","uploadSuccess","setUploadSuccess","navigate","loading","setLoading","handleFileChange","e","selectedFile","target","files","console","log","handleDragOver","preventDefault","stopPropagation","handleDrop","droppedFile","dataTransfer","handleUpload","alert","formData","FormData","append","response","post","headers","data","error","handleExtract","Promise","resolve","setTimeout","name","fetch","method","body","JSON","stringify","fileName","ok","json","state","myData","errorData","message","className","children","onDragOver","onDrop","onClick","document","getElementById","click","type","id","onChange","accept","disabled"],"sources":["C:/Users/USER/Documents/works/crediflow/frontend/src/pages/upload.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Card } from \"../components/ui/card\";\r\nimport { Button } from \"../components/ui/button\";\r\nimport { Upload } from \"lucide-react\";\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst UploadPage = () => {\r\n  const [file, setFile] = useState(null);\r\n  const [uploadSuccess, setUploadSuccess] = useState(false); // Track if upload was successful\r\n  const navigate = useNavigate(); \r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleFileChange = (e) => {\r\n    const selectedFile = e.target.files[0];\r\n    setFile(selectedFile);\r\n    console.log('File selected:', selectedFile);\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const droppedFile = e.dataTransfer.files[0];\r\n    setFile(droppedFile);\r\n    console.log('File dropped:', droppedFile);\r\n  };\r\n\r\n  const handleUpload = async () => { // Make this function async\r\n    if (!file) {\r\n      alert('Please select a file first');\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n\r\n    try {\r\n      // Replace with your Flask API endpoint\r\n      const response = await axios.post('https://crediflowassignmentrepo-production.up.railway.app/upload', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n        },\r\n      });\r\n      console.log('File uploaded successfully:', response.data);\r\n      alert('File uploaded successfully!');\r\n      setUploadSuccess(true);\r\n    } catch (error) {\r\n      console.error('Error uploading file:', error);\r\n      alert('Error uploading file');\r\n    }\r\n  };\r\n\r\n  const handleExtract = async () => {\r\n    try {\r\n      setLoading(true);\r\n      await new Promise(resolve => setTimeout(resolve, 50));\r\n      console.log(\"f name:\", file.name)\r\n      //   API call to start process \r\n      const response = await fetch('https://crediflowassignmentrepo-production.up.railway.app/start-process', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',  //  this is very important\r\n        },\r\n        body: JSON.stringify({\r\n          fileName: file.name,\r\n        }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        console.log('API Success:', data);\r\n\r\n        // Stop loading first\r\n        setLoading(false);\r\n\r\n        // navigate to report\r\n        navigate('/report', { state: { myData: data['message'] } });\r\n      } else {\r\n        //  API failed \r\n        const errorData = await response.json();\r\n        console.error('API Error:', errorData);\r\n\r\n        setLoading(false); // stop loading\r\n        alert(errorData.message || 'Something went wrong. Please try again.');\r\n      }\r\n\r\n\r\n    } catch (error) {\r\n      console.error('Error during extraction:', error);\r\n      alert('Something went wrong. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col items-center justify-center p-4 md:p-8 bg-gradient-to-br from-emerald-600 to-teal-700\">\r\n      <div className=\"w-full max-w-3xl text-center mb-8\">\r\n        <h1 className=\"text-3xl md:text-4xl font-bold text-white mb-2\">Crediflow report</h1>\r\n      </div>\r\n\r\n      <Card className=\"w-full max-w-xl p-6 md:p-8 shadow-2xl bg-white/95 rounded-3xl\">\r\n        <div className=\"text-center mb-6\">\r\n          <h2 className=\"text-2xl font-semibold text-emerald-700\">Upload File</h2>\r\n        </div>\r\n\r\n        <div\r\n          className=\"border-2 border-dashed border-emerald-600/30 rounded-xl p-8 md:p-12 text-center cursor-pointer hover:border-emerald-600/50 transition-colors\"\r\n          onDragOver={handleDragOver}\r\n          onDrop={handleDrop}\r\n          onClick={() => document.getElementById('fileInput').click()}\r\n        >\r\n          <input\r\n            type=\"file\"\r\n            id=\"fileInput\"\r\n            className=\"hidden\"\r\n            onChange={handleFileChange}\r\n            accept=\".pdf,.doc,.docx,.txt\"\r\n          />\r\n          <Upload className=\"mx-auto h-12 w-12 text-emerald-600 mb-4\" />\r\n          <p className=\"text-sm md:text-base text-gray-600 mb-2\">\r\n            Drag and drop your file here or click to browse\r\n          </p>\r\n          <p className=\"text-xs text-gray-500\">\r\n            {file ? file.name : 'Supported formats: PDF, DOC, DOCX, TXT'}\r\n          </p>\r\n        </div>\r\n\r\n        {file && (\r\n          <div className=\"mt-6 text-center\">\r\n            <Button\r\n              // className=\"bg-emerald-600 hover:bg-emerald-700 text-white px-8\"\r\n              className=\"bg-emerald-600 hover:bg-emerald-700 text-white px-10 py-2 text-lg rounded-md\"\r\n              onClick={handleUpload}  // Trigger the file upload when clicked\r\n            >\r\n              Upload File\r\n            </Button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Show Extract button after successful upload */}\r\n        {uploadSuccess && (\r\n          <div className=\"mt-6 text-center\">\r\n            <Button\r\n              className=\"bg-teal-600 hover:bg-teal-700 text-white px-10 py-2 text-lg rounded-md\"\r\n              onClick={handleExtract} disabled={loading}\r\n            >\r\n              {loading ? 'Etracting...' : 'Extract'}\r\n            </Button>\r\n          </div>\r\n        )}\r\n\r\n\r\n\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UploadPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}